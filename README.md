# xliff-merger
_xliff-merger_ is a tool that takes a generated xliff file (_base.xlf_)  and merges it with an existing and already translated xliff file (_other.xlf_).

 It reads every `<trans-unit>` tag found in the _base.xlf_ file and looks for new translations in the _other.xlf_ file. A translation is found as a `<target>` tag, this tag is then copied as a child node of the `<trans-unit>` tag. In the end, the result will be saved in a file called `merged.xlf`, all tags will be indented and sorted by the _id_ attribute.

_xliff-merger_ uses [xslt4node](https://www.npmjs.com/package/xslt4node), _a XSLT package wrapping the XSLT interface of the Java API for XML Processing (JAXP)_.

## Pre-requisites:
* [node-gyp](https://github.com/nodejs/node-gyp)
* Java 6+
  * JNI capabilities must be enabled when running java on a Mac OSX:
    * `/Library/Java/JavaVirtualMachines/<version>.jdk/Contents/Info.plist`
      ``` xml
      <key>JVMCapabilities</key>
      <array>
          ...
          <string>JNI</string>
          ...
      </array>

## Setup:
Run `npm install`

## Usage:
xliff-merger will merge the following files:
* `base.xlf` is the translation file generated by angular, usually: `ng xi18n --i18n-format xlf`
* `other.xlf`is the file with the translations, this is the one that your translation team will sent you back.

Merge the files by running `node xliff-merger.js`

## Future:
* Compile and share this tool to be added to angular projects as a node script.
* Test it using yarn instead of npm
* Find a way to publish this tool to avoid the pre-requisites, [see here.](https://sunzhongkui.wordpress.com/2013/07/26/create-and-publish-node-js-c-addon/)
